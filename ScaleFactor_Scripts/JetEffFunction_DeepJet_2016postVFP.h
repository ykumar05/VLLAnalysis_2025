//bJet Efficiency for 2L exclusive final state
#include <vector>
#include "TMath.h"
using namespace std;

// bTag SF for the event (looped over all jets)
// For "data" efficiency, enter the stored JetDeepMediumCSVSF value
// For "mc" efficiency, enter JetDeepMediumCSVSF as 1.0 !!

// ------------------------------------------------------------------------------------------
// ------------------------------------------------------------------------------------------


// 2016
float AnaScript::bTagSF2016postVFP(int MCSample, vector<Particle>Jet){

  // bogus default values
  float probability_mc = 1.0;
  float probability_data = 1.0;
  float LJetEff[3][8] = { {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   }, {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   }, {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   } };
  float CJetEff[3][8] = { {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   }, {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   }, {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   } };
  float BJetEff[3][8] = { {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   }, {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   }, {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   } };
  //
  // ----------------------

  //For the sample DYJetsToLL_M10to50:
  if(MCSample == 1){
    float BJetEff_temp[3][8] = {{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  
  //For the sample DYJetsToLL_M50:
  if(MCSample == 2){
    float BJetEff_temp[3][8] = {{0.800000011920929, 0.8979591727256775, 0.7647058963775635, 0.9166666865348816, 0.625, 1.0, 1.0, 0.0}, {0.8160919547080994, 0.6764705777168274, 0.8125, 0.5833333134651184, 0.75, 1.0, 0.0, 0.0}, {0.800000011920929, 0.5555555820465088, 0.8999999761581421, 0.6666666865348816, 1.0, 0.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.19540229439735413, 0.06976744532585144, 0.10000000149011612, 0.1428571492433548, 0.0, 0.0, 0.0, 0.0}, {0.1515151560306549, 0.29411765933036804, 0.1304347813129425, 0.0, 0.20000000298023224, 0.0, 0.0, 0.0}, {0.056603774428367615, 0.13333334028720856, 0.2666666805744171, 0.0, 0.0, 1.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.019498607143759727, 0.0058309040032327175, 0.013274336233735085, 0.024793388321995735, 0.0, 0.0, 0.09090909361839294, 0.0}, {0.023255813866853714, 0.007843137718737125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.02380952425301075, 0.0223214291036129, 0.007092198356986046, 0.043478261679410934, 0.0, 0.0, 0.3333333432674408, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //======================================================================//
  //For the sample Rare_THQ:
  if(MCSample == 10){
    float BJetEff_temp[3][8] = {{0.7855014801025391, 0.8274843096733093, 0.8535659909248352, 0.8390297889709473, 0.8414298892021179, 0.8319039344787598, 0.8666666746139526, 0.8500000238418579}, {0.7523524165153503, 0.787350058555603, 0.7993366718292236, 0.8247422575950623, 0.8123077154159546, 0.8364197611808777, 0.8115941882133484, 0.6666666865348816}, {0.6807928681373596, 0.7063403725624084, 0.731168806552887, 0.7398189902305603, 0.7351598143577576, 0.739130437374115, 0.6666666865348816, 0.0}};
    float CJetEff_temp[3][8] = {{0.19736842811107635, 0.17482517659664154, 0.1652892529964447, 0.23333333432674408, 0.2857142984867096, 0.0714285746216774, 0.0, 0.0}, {0.18113207817077637, 0.13855421543121338, 0.18095238506793976, 0.1666666716337204, 0.12244898080825806, 0.125, 0.4000000059604645, 0.0}, {0.19895288348197937, 0.1388888955116272, 0.10204081982374191, 0.2068965584039688, 0.09375, 0.10000000149011612, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.024539876729249954, 0.016314778476953506, 0.010430247522890568, 0.007334963418543339, 0.008928571827709675, 0.030927835032343864, 0.0833333358168602, 0.0}, {0.022336769849061966, 0.016299137845635414, 0.015931373462080956, 0.01515151560306549, 0.029411764815449715, 0.02777777798473835, 0.0535714291036129, 0.0}, {0.028595110401511192, 0.02078137919306755, 0.023786868900060654, 0.01955307275056839, 0.03804347664117813, 0.03999999910593033, 0.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //For the sample Rare_THW:
  if(MCSample == 11){
    float BJetEff_temp[3][8] = {{0.7939256429672241, 0.8207094669342041, 0.8313358426094055, 0.8342776298522949, 0.8282674551010132, 0.8357446789741516, 0.8152866363525391, 0.7565217614173889}, {0.7673981189727783, 0.7879239916801453, 0.7878894209861755, 0.8077968955039978, 0.8189122080802917, 0.8158220052719116, 0.7682291865348816, 0.6222222447395325}, {0.7081776857376099, 0.7035794258117676, 0.7250773906707764, 0.7422389388084412, 0.7575757503509521, 0.748344361782074, 0.7400000095367432, 1.0}};
    float CJetEff_temp[3][8] = {{0.19810576736927032, 0.16306695342063904, 0.14150942862033844, 0.1594594568014145, 0.18940609693527222, 0.14473684132099152, 0.26978418231010437, 0.2822085916996002}, {0.18518517911434174, 0.15933232009410858, 0.16109421849250793, 0.16697247326374054, 0.1875, 0.19548872113227844, 0.2509225010871887, 0.25}, {0.16334661841392517, 0.14447592198848724, 0.11953353136777878, 0.12295082211494446, 0.13924050331115723, 0.1808510571718216, 0.28070175647735596, 0.0}};
    float LJetEff_temp[3][8] = {{0.02855486236512661, 0.019144410267472267, 0.014116460457444191, 0.01365409605205059, 0.018262986093759537, 0.023543260991573334, 0.040028590708971024, 0.05607476457953453}, {0.030035635456442833, 0.019543973729014397, 0.01635139435529709, 0.017124831676483154, 0.01304090116173029, 0.03130590170621872, 0.05234460160136223, 0.07653061300516129}, {0.03408007696270943, 0.018322082236409187, 0.017744705080986023, 0.018166804686188698, 0.019929660484194756, 0.02961672469973564, 0.06923077255487442, 0.0731707289814949}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //For the sample Rare_TTTT:
  if(MCSample == 12){
    float BJetEff_temp[3][8] = {{0.7858408093452454, 0.8115187287330627, 0.8163768649101257, 0.8276981115341187, 0.8325089812278748, 0.8275765776634216, 0.8253530859947205, 0.7434782385826111}, {0.744902491569519, 0.7639265060424805, 0.7904680371284485, 0.7980037331581116, 0.799756646156311, 0.7994207143783569, 0.7920446395874023, 0.7023809552192688}, {0.6863211393356323, 0.7035013437271118, 0.7107047438621521, 0.7132848501205444, 0.7505303621292114, 0.7268292903900146, 0.7118644118309021, 0.8571428656578064}};
    float CJetEff_temp[3][8] = {{0.18098030984401703, 0.166371688246727, 0.14820846915245056, 0.14873646199703217, 0.1630740463733673, 0.17731629312038422, 0.19714964926242828, 0.20408163964748383}, {0.1844365894794464, 0.16679076850414276, 0.1566852331161499, 0.1721014529466629, 0.16404199600219727, 0.21729490160942078, 0.17910447716712952, 0.27272728085517883}, {0.13364055752754211, 0.125, 0.12028985470533371, 0.12795275449752808, 0.156695157289505, 0.21985815465450287, 0.19718310236930847, 0.0}};
    float LJetEff_temp[3][8] = {{0.019072864204645157, 0.012358946725726128, 0.013087170198559761, 0.012881134636700153, 0.010589318349957466, 0.011976048350334167, 0.02668890729546547, 0.03750000149011612}, {0.024108298122882843, 0.014407334849238396, 0.015412240289151669, 0.01365894079208374, 0.018840579316020012, 0.030984507873654366, 0.056179776787757874, 0.10000000149011612}, {0.03000863641500473, 0.019901517778635025, 0.01747756265103817, 0.022206304594874382, 0.022001048550009727, 0.024713151156902313, 0.06211180239915848, 0.20000000298023224}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //For the sample Rare_TTWH:
  if(MCSample == 13){
    float BJetEff_temp[3][8] = {{0.8066914677619934, 0.8326693177223206, 0.8270440101623535, 0.8483606576919556, 0.8177083134651184, 0.855555534362793, 0.7297297120094299, 0.75}, {0.7664974331855774, 0.8032786846160889, 0.8163265585899353, 0.7965116500854492, 0.7884615659713745, 0.7894737124443054, 0.7647058963775635, 1.0}, {0.6330274939537048, 0.7093023061752319, 0.6631578803062439, 0.7922077775001526, 0.8108108043670654, 0.8571428656578064, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.2028985470533371, 0.1428571492433548, 0.1860465109348297, 0.15625, 0.125, 0.2666666805744171, 0.30000001192092896, 0.0}, {0.2068965584039688, 0.24390244483947754, 0.14705882966518402, 0.1538461595773697, 0.0833333358168602, 0.27272728085517883, 0.0, 0.0}, {0.13333334028720856, 0.125, 0.2222222238779068, 0.1111111119389534, 0.09090909361839294, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.024539876729249954, 0.027027027681469917, 0.009852216579020023, 0.021276595070958138, 0.01149425283074379, 0.040816325694322586, 0.029411764815449715, 0.0}, {0.04560260474681854, 0.0066225165501236916, 0.029629629105329514, 0.02150537632405758, 0.016129031777381897, 0.03030303120613098, 0.0, 0.0}, {0.02923976629972458, 0.03658536449074745, 0.025641025975346565, 0.0181818176060915, 0.0, 0.0, 0.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //For the sample Rare_TTWW:
  if(MCSample == 14){
    float BJetEff_temp[3][8] = {{0.7935779690742493, 0.823825478553772, 0.8244897723197937, 0.869369387626648, 0.8314606547355652, 0.8571428656578064, 0.8181818127632141, 0.7142857313156128}, {0.7648261785507202, 0.7627118825912476, 0.8293172717094421, 0.8018018007278442, 0.8118466734886169, 0.7844311594963074, 0.75, 1.0}, {0.689393937587738, 0.7095588445663452, 0.7594936490058899, 0.7354838848114014, 0.7636363506317139, 0.7446808218955994, 0.4285714328289032, 0.0}};
    float CJetEff_temp[3][8] = {{0.1910112351179123, 0.10738255083560944, 0.19285714626312256, 0.1538461595773697, 0.15662650763988495, 0.11538461595773697, 0.2750000059604645, 0.30000001192092896}, {0.2153846174478531, 0.15789473056793213, 0.27173912525177, 0.19117647409439087, 0.13953489065170288, 0.28125, 0.3214285671710968, 0.0}, {0.1827957034111023, 0.14814814925193787, 0.1733333319425583, 0.10526315867900848, 0.1304347813129425, 0.0833333358168602, 0.3333333432674408, 0.0}};
    float LJetEff_temp[3][8] = {{0.014973262324929237, 0.0032573288772255182, 0.0018761726096272469, 0.010152284055948257, 0.019108280539512634, 0.01075268816202879, 0.031578946858644485, 0.0}, {0.01953602023422718, 0.004347825888544321, 0.012474012561142445, 0.0069204154424369335, 0.0, 0.032786883413791656, 0.015384615398943424, 0.1538461595773697}, {0.032374098896980286, 0.013289036229252815, 0.021834060549736023, 0.019607843831181526, 0.008474576286971569, 0.0714285746216774, 0.05000000074505806, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //For the sample Rare_TTWZ:
  if(MCSample == 15){
    float BJetEff_temp[3][8] = {{0.8253968358039856, 0.8041542768478394, 0.8372092843055725, 0.8253968358039856, 0.8327974081039429, 0.8511627912521362, 0.7976190447807312, 0.8695651888847351}, {0.7630661725997925, 0.7876448035240173, 0.8168498277664185, 0.80078125, 0.75, 0.8425925970077515, 0.7659574747085571, 1.0}, {0.6736111044883728, 0.7166666388511658, 0.71875, 0.6517857313156128, 0.7042253613471985, 0.6333333253860474, 0.8571428656578064, 1.0}};
    float CJetEff_temp[3][8] = {{0.17142857611179352, 0.1320754736661911, 0.1875, 0.14705882966518402, 0.2068965584039688, 0.3333333432674408, 0.25, 0.6000000238418579}, {0.14406779408454895, 0.17894737422466278, 0.23999999463558197, 0.145454540848732, 0.15789473056793213, 0.25806450843811035, 0.2666666805744171, 0.6666666865348816}, {0.22727273404598236, 0.15217390656471252, 0.09259258955717087, 0.1071428582072258, 0.2222222238779068, 0.20000000298023224, 0.4000000059604645, 0.0}};
    float LJetEff_temp[3][8] = {{0.02698412723839283, 0.011848341673612595, 0.010695187374949455, 0.006557377055287361, 0.011299435049295425, 0.0181818176060915, 0.03333333507180214, 0.0}, {0.019607843831181526, 0.017595307901501656, 0.013745704665780067, 0.01744186133146286, 0.015267175622284412, 0.021739130839705467, 0.09756097197532654, 0.3333333432674408}, {0.019178081303834915, 0.022123893722891808, 0.02500000037252903, 0.0, 0.051948051899671555, 0.0, 0.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  
  //For the sample Rare_TTZH:
  if(MCSample == 16){
    float BJetEff_temp[3][8] = {{0.8141025900840759, 0.8325688242912292, 0.8235294222831726, 0.8086560368537903, 0.875, 0.8728813529014587, 0.8088235259056091, 0.8461538553237915}, {0.7550432085990906, 0.7483870983123779, 0.8169398903846741, 0.7857142686843872, 0.8059701323509216, 0.792792797088623, 0.8085106611251831, 1.0}, {0.6831682920455933, 0.7304964661598206, 0.7777777910232544, 0.70652174949646, 0.7285714149475098, 0.6774193644523621, 0.75, 0.0}};
    float CJetEff_temp[3][8] = {{0.20000000298023224, 0.11818181723356247, 0.1649484485387802, 0.17142857611179352, 0.1428571492433548, 0.20000000298023224, 0.125, 1.0}, {0.2210526317358017, 0.18965516984462738, 0.12121212482452393, 0.1666666716337204, 0.17777778208255768, 0.17391304671764374, 0.4444444477558136, 1.0}, {0.1666666716337204, 0.1538461595773697, 0.0731707289814949, 0.043478261679410934, 0.2142857164144516, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.023328149691224098, 0.01900237612426281, 0.0025252525229007006, 0.018382353708148003, 0.010638297535479069, 0.018691588193178177, 0.0, 0.0}, {0.03867403417825699, 0.029801324009895325, 0.00401606410741806, 0.031578946858644485, 0.0446428582072258, 0.014492753893136978, 0.07692307978868484, 0.0}, {0.028901733458042145, 0.012987012974917889, 0.01342281885445118, 0.025641025975346565, 0.0, 0.14705882966518402, 0.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //For the sample Rare_TTZZ:
  if(MCSample == 17){
    float BJetEff_temp[3][8] = {{0.759637176990509, 0.8190255165100098, 0.807692289352417, 0.8548009395599365, 0.8247126340866089, 0.7609755992889404, 0.7816091775894165, 0.8260869383811951}, {0.7195122241973877, 0.7759197354316711, 0.7894737124443054, 0.7654722929000854, 0.8279069662094116, 0.801886796951294, 0.7758620977401733, 0.6666666865348816}, {0.7015706896781921, 0.6369863152503967, 0.7421383857727051, 0.7169811129570007, 0.6666666865348816, 0.7407407164573669, 0.7777777910232544, 1.0}};
    float CJetEff_temp[3][8] = {{0.17518247663974762, 0.15217390656471252, 0.17796610295772552, 0.1310344785451889, 0.10752688348293304, 0.23999999463558197, 0.42105263471603394, 0.20000000298023224}, {0.1589404046535492, 0.19587628543376923, 0.1794871836900711, 0.23188406229019165, 0.2083333283662796, 0.1538461595773697, 0.29411765933036804, 0.0}, {0.2291666716337204, 0.15094339847564697, 0.18918919563293457, 0.1538461595773697, 0.1428571492433548, 0.0, 0.20000000298023224, 0.0}};
    float LJetEff_temp[3][8] = {{0.017287233844399452, 0.0173611119389534, 0.010438413359224796, 0.018518518656492233, 0.019157087430357933, 0.02985074557363987, 0.025974025949835777, 0.2222222238779068}, {0.026479750871658325, 0.01291989628225565, 0.008287292905151844, 0.01171875, 0.01075268816202879, 0.028037382289767265, 0.01923076994717121, 1.0}, {0.025581395253539085, 0.01652892492711544, 0.02185792289674282, 0.024000000208616257, 0.014285714365541935, 0.0, 0.1428571492433548, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //======================================================================//
  
  //For the sample ZZ_ZZTo4L:
  if(MCSample == 22){
    float BJetEff_temp[3][8] = {{0.7748436331748962, 0.8063750267028809, 0.8073679804801941, 0.8260536193847656, 0.8178137540817261, 0.7911392450332642, 0.7565217614173889, 0.8181818127632141}, {0.7512497305870056, 0.7805456519126892, 0.7967302203178406, 0.798617959022522, 0.8026315569877625, 0.7644444704055786, 0.8399999737739563, 0.6666666865348816}, {0.6652482151985168, 0.7049709558486938, 0.703773558139801, 0.7417103052139282, 0.7136929631233215, 0.737864077091217, 0.7333333492279053, 0.0}};
    float CJetEff_temp[3][8] = {{0.17661431431770325, 0.15870216488838196, 0.15261422097682953, 0.13866877555847168, 0.1574746072292328, 0.1624605655670166, 0.19367589056491852, 0.3684210479259491}, {0.16702334582805634, 0.15494103729724884, 0.14369748532772064, 0.15223880112171173, 0.155251145362854, 0.1740139275789261, 0.10738255083560944, 0.0}, {0.15628430247306824, 0.14649681746959686, 0.1284448802471161, 0.10957642644643784, 0.1217038556933403, 0.1553398072719574, 0.2380952388048172, 0.0}};
    float LJetEff_temp[3][8] = {{0.036910708993673325, 0.018956538289785385, 0.013665413483977318, 0.011732767336070538, 0.009270500391721725, 0.014216405339539051, 0.02817695215344429, 0.04219409450888634}, {0.041280388832092285, 0.02269054763019085, 0.01651463657617569, 0.015409078449010849, 0.016453763470053673, 0.02431384287774563, 0.04301533102989197, 0.11881188303232193}, {0.04777497053146362, 0.02675015479326248, 0.02051045373082161, 0.020255424082279205, 0.021431632339954376, 0.031033223494887352, 0.04617834463715553, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }    


  //For the sample GluGluToContintoZZ_ZZTo4E:
  if(MCSample == 24){
    float BJetEff_temp[3][8] = {{0.7596490979194641, 0.7699386477470398, 0.7931034564971924, 0.782608687877655, 0.7407407164573669, 1.0, 1.0, 0.0}, {0.7011494040489197, 0.7260726094245911, 0.7164948582649231, 0.737500011920929, 0.739130437374115, 0.5, 0.0, 0.0}, {0.625250518321991, 0.7042253613471985, 0.6808510422706604, 0.6875, 0.7647058963775635, 1.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.185555562376976, 0.17895878851413727, 0.16987740993499756, 0.1569506675004959, 0.23076923191547394, 0.27272728085517883, 0.5, 0.0}, {0.1496437042951584, 0.12918660044670105, 0.18197278678417206, 0.10471203923225403, 0.125, 0.1764705926179886, 0.0, 0.0}, {0.13436123728752136, 0.13219285011291504, 0.13785046339035034, 0.13375796377658844, 0.054054055362939835, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.0361376591026783, 0.022694237530231476, 0.016593005508184433, 0.012732417322695255, 0.017704518511891365, 0.009999999776482582, 0.029411764815449715, 0.0}, {0.04099518060684204, 0.020118864253163338, 0.017411209642887115, 0.018031014129519463, 0.020072054117918015, 0.04436229169368744, 0.051948051899671555, 0.5}, {0.042469337582588196, 0.019607843831181526, 0.017775412648916245, 0.014121037907898426, 0.015429122373461723, 0.014218009077012539, 0.029411764815449715, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //For the sample GluGluToContintoZZ_ZZTo4Mu:
  if(MCSample == 25){
    float BJetEff_temp[3][8] = {{0.8021390438079834, 0.7773722410202026, 0.841269850730896, 0.8831169009208679, 0.8620689511299133, 1.0, 0.0, 0.0}, {0.7412008047103882, 0.79296875, 0.8192090392112732, 0.7894737124443054, 0.8571428656578064, 0.6000000238418579, 1.0, 0.0}, {0.6650717854499817, 0.7323232293128967, 0.7401574850082397, 0.7291666865348816, 0.8571428656578064, 1.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.17239010334014893, 0.19018404185771942, 0.1492537260055542, 0.18994413316249847, 0.095238097012043, 0.3529411852359772, 0.3333333432674408, 0.0}, {0.17675378918647766, 0.18471337854862213, 0.1609756052494049, 0.14210526645183563, 0.1492537260055542, 0.0, 0.0, 0.0}, {0.1522965282201767, 0.14666666090488434, 0.13445378839969635, 0.10606060922145844, 0.09090909361839294, 0.2222222238779068, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.01829518750309944, 0.012097812257707119, 0.007204023189842701, 0.011702529154717922, 0.006435006391257048, 0.013888888992369175, 0.0, 0.0}, {0.021560372784733772, 0.014482258819043636, 0.010481586679816246, 0.010598031803965569, 0.01001251582056284, 0.018292682245373726, 0.0357142873108387, 0.0}, {0.03895490989089012, 0.022715749219059944, 0.018019406124949455, 0.020197857171297073, 0.025039123371243477, 0.056910570710897446, 0.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //For the sample GluGluToContintoZZ_ZZTo2E2Mu:
  if(MCSample == 26){
    float BJetEff_temp[3][8] = {{0.738095223903656, 0.7785235047340393, 0.800000011920929, 0.7631579041481018, 0.8461538553237915, 1.0, 1.0, 0.0}, {0.6804511547088623, 0.7652173638343811, 0.7471264600753784, 0.8275862336158752, 0.8888888955116272, 0.0, 1.0, 0.0}, {0.6627451181411743, 0.6902654767036438, 0.7530864477157593, 0.7599999904632568, 1.0, 1.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.1780821979045868, 0.19825707376003265, 0.1487341821193695, 0.1318681389093399, 0.25, 0.1111111119389534, 0.0, 0.0}, {0.17081448435783386, 0.14833760261535645, 0.12328767031431198, 0.11304347962141037, 0.05263157933950424, 0.25, 0.0, 0.0}, {0.14927536249160767, 0.1465798020362854, 0.11587982624769211, 0.1527777761220932, 0.13333334028720856, 0.1428571492433548, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.033572789281606674, 0.020603688433766365, 0.015345700085163116, 0.01483541913330555, 0.02401129901409149, 0.019138755276799202, 0.08620689809322357, 0.0}, {0.036470361053943634, 0.018562816083431244, 0.01693037897348404, 0.02128530479967594, 0.015990160405635834, 0.04326923191547394, 0.11538461595773697, 0.0}, {0.04244861379265785, 0.023038256913423538, 0.01558917947113514, 0.021263670176267624, 0.01840490847826004, 0.04273504391312599, 0.125, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //======================================================================//
  
  //For the sample WZ_WZTo3LNu:
  if(MCSample == 31){
    float BJetEff_temp[3][8] = {{0.7311320900917053, 0.7572815418243408, 0.7481481432914734, 0.7303370833396912, 0.6709677577018738, 0.7014925479888916, 0.7066666483879089, 0.800000011920929}, {0.6577540040016174, 0.7474402785301208, 0.7457627058029175, 0.6708860993385315, 0.6875, 0.7222222089767456, 0.7432432174682617, 0.8571428656578064}, {0.6119734048843384, 0.686170220375061, 0.5902777910232544, 0.6236559152603149, 0.6530612111091614, 0.5151515007019043, 0.6000000238418579, 0.0}};
    float CJetEff_temp[3][8] = {{0.1792178452014923, 0.15781448781490326, 0.1472311019897461, 0.14949354529380798, 0.15845070779323578, 0.15657620131969452, 0.2032742202281952, 0.2705882489681244}, {0.16612021625041962, 0.1569221466779709, 0.15196599066257477, 0.1526464968919754, 0.15745501220226288, 0.17997869849205017, 0.21564482152462006, 0.3142857253551483}, {0.14956647157669067, 0.1494140625, 0.12046711891889572, 0.12015137076377869, 0.12247838824987411, 0.14910025894641876, 0.2142857164144516, 0.6666666865348816}};
    float LJetEff_temp[3][8] = {{0.013661614619195461, 0.008481992408633232, 0.006896278355270624, 0.006449532229453325, 0.007373020052909851, 0.011001965031027794, 0.02380952425301075, 0.07534246891736984}, {0.017619824036955833, 0.010293139144778252, 0.010110119357705116, 0.009963889606297016, 0.01206568069756031, 0.01946372725069523, 0.0420527458190918, 0.07352941483259201}, {0.026922335848212242, 0.016711561009287834, 0.014577686786651611, 0.01729910634458065, 0.02197447046637535, 0.028233937919139862, 0.05307994782924652, 0.0615384615957737}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //======================================================================//

  //For the sample WW_WWTo1L1Nu2Q:
  if(MCSample == 40){
    float BJetEff_temp[3][8] = {{0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.20000000298023224, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.0357142873108387, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
    
  //For the sample WW_WWTo2L2Nu:
  if(MCSample == 41){
    float BJetEff_temp[3][8] = {{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.3333333432674408, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.0, 0.0, 0.0, 0.0714285746216774, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.05000000074505806, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
    
  //======================================================================//
  
  //For the sample SingleTop_t-channel_Top:
  if(MCSample == 50){
    float BJetEff_temp[3][8] = {{1.0, 0.8181818127632141, 0.8888888955116272, 0.6000000238418579, 0.800000011920929, 1.0, 0.0, 0.0}, {0.8333333134651184, 0.8461538553237915, 0.5, 0.800000011920929, 0.0, 1.0, 0.0, 0.0}, {0.6666666865348816, 0.75, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.3333333432674408, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.3333333432674408, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
      
  //For the sample SingleTop_t-channel_AntiTop:
  if(MCSample == 51){
    float BJetEff_temp[3][8] = {{0.7777777910232544, 1.0, 0.875, 0.5, 0.5, 0.0, 0.0, 0.0}, {0.6666666865348816, 1.0, 1.0, 0.5, 0.0, 0.0, 1.0, 0.0}, {1.0, 0.5, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 1.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};

    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //For the sample SingleTop_s-channel_LeptonDecays:
  if(MCSample == 52){
    float BJetEff_temp[3][8] = {{0.75, 0.8333333134651184, 0.8333333134651184, 1.0, 0.0, 0.0, 1.0, 0.0}, {1.0, 0.8333333134651184, 0.6666666865348816, 1.0, 0.0, 1.0, 0.0, 0.0}, {0.75, 1.0, 0.6666666865348816, 0.5, 0.5, 1.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }  
    
  //For the sample SingleTop_tW_AntiTop:
  if(MCSample == 53){
    float BJetEff_temp[3][8] = {{0.9090909361839294, 0.7333333492279053, 1.0, 0.8571428656578064, 1.0, 0.0, 0.0, 0.0}, {0.6666666865348816, 0.5555555820465088, 0.7777777910232544, 1.0, 1.0, 0.0, 0.5, 0.0}, {0.7777777910232544, 0.6666666865348816, 1.0, 0.6666666865348816, 0.0, 0.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.10526315867900848, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.125, 0.0, 0.0, 0.0, 0.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  
  //For the sample SingleTop_tW_Top:
  if(MCSample == 54){
    float BJetEff_temp[3][8] = {{0.47058823704719543, 0.7142857313156128, 0.7692307829856873, 0.75, 0.75, 0.0, 1.0, 0.0}, {0.8125, 0.875, 0.7692307829856873, 1.0, 0.800000011920929, 0.0, 1.0, 0.0}, {1.0, 0.8571428656578064, 0.75, 0.75, 0.6666666865348816, 0.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.0, 0.3333333432674408, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};

    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //======================================================================//

  //For the sample TTBar_TTToSemiLeptonic:
  if(MCSample == 61){
    float BJetEff_temp[3][8] = {{0.803108811378479, 0.8553459048271179, 0.8271604776382446, 0.8316831588745117, 0.8548387289047241, 0.9090909361839294, 1.0, 0.0}, {0.7209302186965942, 0.807692289352417, 0.798561155796051, 0.7746478915214539, 0.7941176295280457, 1.0, 0.75, 0.0}, {0.6142857074737549, 0.7972972989082336, 0.7254902124404907, 0.8965517282485962, 0.6428571343421936, 0.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.15000000596046448, 0.17499999701976776, 0.19298245012760162, 0.3055555522441864, 0.0625, 0.0, 0.0, 0.0}, {0.190476194024086, 0.20338982343673706, 0.15789473056793213, 0.12820513546466827, 0.1428571492433548, 0.0, 0.5, 1.0}, {0.18644067645072937, 0.11428571492433548, 0.1388888955116272, 0.13333334028720856, 0.0, 0.3333333432674408, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.012345679104328156, 0.0044843051582574844, 0.005917159840464592, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.01600000075995922, 0.017391303554177284, 0.012903225608170033, 0.009999999776482582, 0.01785714365541935, 0.03703703731298447, 0.1666666716337204, 0.0}, {0.040441177785396576, 0.05511811003088951, 0.024793388321995735, 0.03703703731298447, 0.0, 0.0476190485060215, 0.0, 0.0}};
 
      for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
      
  //For the sample TTBar_TTTo2L2Nu:
  if(MCSample == 60){
    float BJetEff_temp[3][8] = {{0.7927576899528503, 0.8267667293548584, 0.836870014667511, 0.8362069129943848, 0.8537200689315796, 0.8394495248794556, 0.8085106611251831, 0.0}, {0.7613122463226318, 0.7808628678321838, 0.8176156878471375, 0.8414731621742249, 0.8207023739814758, 0.8116883039474487, 0.875, 0.0}, {0.6727890968322754, 0.6959640979766846, 0.7107942700386047, 0.7657480239868164, 0.7663043737411499, 0.7169811129570007, 0.6666666865348816, 0.0}};
    float CJetEff_temp[3][8] = {{0.197247713804245, 0.19387754797935486, 0.1538461595773697, 0.06818182021379471, 0.10000000149011612, 0.23999999463558197, 0.25, 0.6666666865348816}, {0.2150000035762787, 0.12121212482452393, 0.1599999964237213, 0.1458333283662796, 0.07894736528396606, 0.1538461595773697, 0.30000001192092896, 0.0}, {0.1708860695362091, 0.10389610379934311, 0.10606060922145844, 0.1666666716337204, 0.13636364042758942, 0.3333333432674408, 0.1111111119389534, 0.0}};
    float LJetEff_temp[3][8] = {{0.018384767696261406, 0.014716187492012978, 0.015340364538133144, 0.019543973729014397, 0.009852216579020023, 0.004464285913854837, 0.008620689623057842, 0.25}, {0.02033333294093609, 0.010408326983451843, 0.011044176295399666, 0.00827814545482397, 0.007751937955617905, 0.0476190485060215, 0.03100775182247162, 0.25}, {0.02923310548067093, 0.019699811935424805, 0.018450183793902397, 0.0235294122248888, 0.037151701748371124, 0.037837836891412735, 0.09876543283462524, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  
  //======================================================================//

  //For the sample TTZ_TTZToLL:
  if(MCSample == 80){
    float BJetEff_temp[3][8] = {{0.7866455912590027, 0.8120283484458923, 0.8251972794532776, 0.8313329219818115, 0.8330466151237488, 0.8316593170166016, 0.8156024813652039, 0.7479435801506042}, {0.7480049729347229, 0.7788230776786804, 0.7933223247528076, 0.8014028072357178, 0.8054790496826172, 0.8003104329109192, 0.7792161703109741, 0.7366985082626343}, {0.6771260499954224, 0.7040972709655762, 0.7229121327400208, 0.7290863394737244, 0.7410999536514282, 0.7385090589523315, 0.7374115586280823, 0.6470588445663452}};
    float CJetEff_temp[3][8] = {{0.1839674413204193, 0.16069531440734863, 0.15179985761642456, 0.14762160181999207, 0.15737928450107574, 0.17466051876544952, 0.2127446085214615, 0.2346041053533554}, {0.17770417034626007, 0.16195522248744965, 0.15112383663654327, 0.15441519021987915, 0.1637580543756485, 0.18471337854862213, 0.21864952147006989, 0.23030303418636322}, {0.15763600170612335, 0.14158305525779724, 0.12607663869857788, 0.1318645179271698, 0.143295019865036, 0.1638288050889969, 0.21408045291900635, 0.3913043439388275}};
    float LJetEff_temp[3][8] = {{0.01973092555999756, 0.012345372699201107, 0.011046820320189, 0.010393049567937851, 0.01161673292517662, 0.013936037197709084, 0.028079282492399216, 0.05953582376241684}, {0.02175726182758808, 0.014343815855681896, 0.013375652953982353, 0.014057301916182041, 0.016379160806536674, 0.02277156338095665, 0.0469113327562809, 0.11838006228208542}, {0.02814675122499466, 0.019478745758533478, 0.017919741570949554, 0.017986329272389412, 0.02224767953157425, 0.03452296182513237, 0.06510251760482788, 0.1319444477558136}};

    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
   
  //For the sample TTW_TTWToLNu:
  if(MCSample == 81){
    float BJetEff_temp[3][8] = {{0.7877979874610901, 0.8232070803642273, 0.8300337195396423, 0.8264209032058716, 0.8384242057800293, 0.8421357870101929, 0.814254879951477, 0.75}, {0.7549251317977905, 0.7701946496963501, 0.7937147617340088, 0.8103448152542114, 0.8196860551834106, 0.806584358215332, 0.7808219194412231, 0.75}, {0.6777576804161072, 0.7177534699440002, 0.7340019345283508, 0.7344931960105896, 0.7238371968269348, 0.7777777910232544, 0.7543859481811523, 1.0}};
    float CJetEff_temp[3][8] = {{0.15404699742794037, 0.09765625, 0.15040650963783264, 0.18324607610702515, 0.13414634764194489, 0.1972789168357849, 0.16326530277729034, 0.3333333432674408}, {0.16246499121189117, 0.1726907640695572, 0.13942307233810425, 0.12865497171878815, 0.15199999511241913, 0.1428571492433548, 0.17391304671764374, 0.4444444477558136}, {0.12809917330741882, 0.1111111119389534, 0.16101695597171783, 0.1071428582072258, 0.12328767031431198, 0.1111111119389534, 0.17241379618644714, 1.0}};
    float LJetEff_temp[3][8] = {{0.01836773380637169, 0.011371713131666183, 0.007758620660752058, 0.010657194070518017, 0.009142053313553333, 0.01044386439025402, 0.03030303120613098, 0.07575757801532745}, {0.020453045144677162, 0.009659807197749615, 0.006009013392031193, 0.013531799428164959, 0.015741508454084396, 0.01912858709692955, 0.042995840311050415, 0.10679611563682556}, {0.027833571657538414, 0.01444912701845169, 0.017531557008624077, 0.011988012120127678, 0.019206145778298378, 0.02471482940018177, 0.08503401279449463, 0.20000000298023224}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
    
  //======================================================================//
  
  //For the sample WWW_Inclusive:
  if(MCSample == 90){
    float BJetEff_temp[3][8] = {{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.5, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0}, {1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0}, {0.3333333432674408, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.0, 0.0, 0.0, 0.0, 0.0, 0.10000000149011612, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0416666679084301, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  
  //For the sample WWZ_Inclusive:
  if(MCSample == 91){
    float BJetEff_temp[3][8] = {{0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.0625, 0.3076923191547394, 0.1818181872367859, 0.0, 0.0, 0.1666666716337204, 0.25, 0.0}, {0.1538461595773697, 0.2222222238779068, 0.3333333432674408, 0.0, 0.25, 0.0, 0.0, 0.0}, {0.10000000149011612, 0.0, 0.25, 0.0, 0.20000000298023224, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.0, 0.0, 0.0, 0.0, 0.032258063554763794, 0.0, 0.0, 0.0}, {0.05882352963089943, 0.022727273404598236, 0.024390242993831635, 0.027027027681469917, 0.0, 0.1111111119389534, 0.1428571492433548, 0.0}, {0.0, 0.0, 0.10000000149011612, 0.0, 0.0, 0.2857142984867096, 0.0, 0.0}};

    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
    
    
  //For the sample WZZ_Inclusive:
  if(MCSample == 92){
    float BJetEff_temp[3][8] = {{0.5789473652839661, 0.8636363744735718, 1.0, 0.8461538553237915, 0.75, 1.0, 1.0, 0.0}, {0.9333333373069763, 0.9166666865348816, 0.9230769276618958, 1.0, 1.0, 0.6666666865348816, 1.0, 0.5}, {0.38461539149284363, 0.75, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.23333333432674408, 0.3333333432674408, 0.07407407462596893, 0.0833333358168602, 0.0, 0.1428571492433548, 0.25, 0.0}, {0.1599999964237213, 0.23076923191547394, 0.1538461595773697, 0.20000000298023224, 0.3333333432674408, 0.125, 0.0, 0.0}, {0.3333333432674408, 0.2142857164144516, 0.125, 0.20000000298023224, 0.0, 0.3333333432674408, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.0051282052882015705, 0.014492753893136978, 0.0, 0.0, 0.013888888992369175, 0.0, 0.0, 0.20000000298023224}, {0.05844155699014664, 0.009803921915590763, 0.0, 0.0, 0.0, 0.022727273404598236, 0.0882352963089943, 0.0}, {0.0317460335791111, 0.0, 0.012987012974917889, 0.0, 0.0, 0.043478261679410934, 0.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
    
  //For the sample ZZZ_Inclusive:
  if(MCSample == 93){
    float BJetEff_temp[3][8] = {{0.75, 0.8888888955116272, 1.0, 0.5, 0.0, 1.0, 1.0, 0.0}, {0.875, 0.75, 1.0, 1.0, 0.6666666865348816, 1.0, 1.0, 1.0}, {1.0, 1.0, 0.25, 1.0, 0.0, 0.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.25, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.1111111119389534, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.25, 0.20000000298023224, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.013333333656191826, 0.02857142873108387, 0.0, 0.09090909361839294, 0.0, 0.0, 0.0, 0.0}, {0.019607843831181526, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.07692307978868484, 0.125, 0.0, 0.0, 0.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //======================================================================//

  //For the sample ZGamma_ZGToLLG:
  if(MCSample == 94){
    float BJetEff_temp[3][8] = {{0.7753509879112244, 0.8119122385978699, 0.8128078579902649, 0.8918918967247009, 0.8269230723381042, 0.9629629850387573, 1.0, 0.0}, {0.7622789740562439, 0.7546468377113342, 0.8176795840263367, 0.7789473533630371, 0.8823529481887817, 0.7222222089767456, 1.0, 0.0}, {0.6571428775787354, 0.708737850189209, 0.6930692791938782, 0.739130437374115, 0.782608687877655, 1.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.1677524447441101, 0.13235294818878174, 0.1822429895401001, 0.1269230842590332, 0.16417910158634186, 0.25, 0.2777777910232544, 0.0}, {0.17037753760814667, 0.15485075116157532, 0.14480873942375183, 0.11940298229455948, 0.12631578743457794, 0.17142857611179352, 0.25, 1.0}, {0.16797900199890137, 0.14848485589027405, 0.14678898453712463, 0.17391304671764374, 0.10447761416435242, 0.1818181872367859, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.01667875237762928, 0.010434452444314957, 0.008591512218117714, 0.006915629375725985, 0.005789909046143293, 0.02086956612765789, 0.004464285913854837, 0.0}, {0.020605159923434258, 0.012173913419246674, 0.007028753869235516, 0.011210761964321136, 0.014184396713972092, 0.02008928544819355, 0.037974681705236435, 0.0}, {0.03274528682231903, 0.016339870169758797, 0.014204545877873898, 0.01075268816202879, 0.015384615398943424, 0.0229357797652483, 0.09375, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //======================================================================//

  //For the sample bbH_HToZZTo4L
  if(MCSample == 100){
    float BJetEff_temp[3][8] = {{0.7649314999580383, 0.8204419612884521, 0.834932804107666, 0.8387096524238586, 0.8999999761581421, 0.875, 0.800000011920929, 0.0}, {0.7445255517959595, 0.7818182110786438, 0.8215962648391724, 0.8333333134651184, 0.8500000238418579, 0.875, 0.9375, 0.0}, {0.6655629277229309, 0.6871287226676941, 0.7456446290016174, 0.7605633735656738, 0.6935483813285828, 0.7368420958518982, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.16766467690467834, 0.12121212482452393, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.13821138441562653, 0.0625, 0.2857142984867096, 1.0, 0.0, 0.0, 0.0, 0.0}, {0.14953270554542542, 0.13333334028720856, 0.09090909361839294, 0.0, 1.0, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.03193146362900734, 0.018487395718693733, 0.044247787445783615, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.04006284475326538, 0.014150943607091904, 0.0069444444961845875, 0.05000000074505806, 0.25, 0.0, 0.0, 0.0}, {0.03442959859967232, 0.01957295462489128, 0.016129031777381897, 0.0, 0.0, 0.0, 0.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
      
  //For the sample GluGluHToZZTo4L
  if(MCSample == 101){
    float BJetEff_temp[3][8] = {{0.7478991746902466, 0.7547169923782349, 0.6739130616188049, 0.800000011920929, 0.8571428656578064, 0.5454545617103577, 0.800000011920929, 0.0}, {0.7526881694793701, 0.8666666746139526, 0.75, 0.9047619104385376, 0.9090909361839294, 0.8333333134651184, 0.0, 0.0}, {0.6631578803062439, 0.6458333134651184, 0.75, 0.8823529481887817, 0.5, 0.5714285969734192, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.14084507524967194, 0.1785714328289032, 0.19847328960895538, 0.1388888955116272, 0.11764705926179886, 0.17391304671764374, 0.11764705926179886, 0.0}, {0.13649851083755493, 0.16875000298023224, 0.1953125, 0.1538461595773697, 0.17391304671764374, 0.15789473056793213, 0.1428571492433548, 0.0}, {0.12334802001714706, 0.2075471729040146, 0.03333333507180214, 0.06521739065647125, 0.05263157933950424, 0.1666666716337204, 0.3333333432674408, 0.0}};
    float LJetEff_temp[3][8] = {{0.032729316502809525, 0.01200686115771532, 0.00953389797359705, 0.009657594375312328, 0.006702412851154804, 0.021447721868753433, 0.04651162773370743, 0.0}, {0.0316164456307888, 0.01074870303273201, 0.008022923022508621, 0.017543859779834747, 0.010889291763305664, 0.02675585262477398, 0.05000000074505806, 0.0}, {0.04154361039400101, 0.01781296357512474, 0.015661707147955894, 0.008733624592423439, 0.020151132717728615, 0.024390242993831635, 0.019999999552965164, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //For the sample GluGluToZH_HToZZTo4L
  if(MCSample == 102){
    float BJetEff_temp[3][8] = {{0.7816239595413208, 0.8417350649833679, 0.8382264971733093, 0.8641087412834167, 0.8472440838813782, 0.8834080696105957, 0.8648648858070374, 1.0}, {0.7324841022491455, 0.7692307829856873, 0.8062605857849121, 0.8301675915718079, 0.8646789193153381, 0.8474576473236084, 0.9473684430122375, 0.0}, {0.678223192691803, 0.6946428418159485, 0.7203065156936646, 0.7212543487548828, 0.7950819730758667, 0.7419354915618896, 1.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.1974944770336151, 0.16936416923999786, 0.1719483584165573, 0.16757600009441376, 0.18730159103870392, 0.2331606149673462, 0.3571428656578064, 0.0}, {0.17720907926559448, 0.15835312008857727, 0.16419142484664917, 0.15347722172737122, 0.18284423649311066, 0.2410714328289032, 0.2666666805744171, 0.0}, {0.15933610498905182, 0.17465223371982574, 0.13539652526378632, 0.15902140736579895, 0.16129031777381897, 0.2702702581882477, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.03447624295949936, 0.022026430815458298, 0.01589418761432171, 0.014185553416609764, 0.018143754452466965, 0.022781774401664734, 0.028169013559818268, 0.0}, {0.037008773535490036, 0.024109262973070145, 0.021781878545880318, 0.02024197392165661, 0.02516033500432968, 0.02798507548868656, 0.016393441706895828, 0.0}, {0.04136233776807785, 0.02110321819782257, 0.02282947115600109, 0.027890760451555252, 0.031770046800374985, 0.057553958147764206, 0.0, 0.0}};

    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }  
    
  //For the sample GluGluZH_HToWW_ZTo2L
  if(MCSample == 103){
    float BJetEff_temp[3][8] = {{0.8863636255264282, 0.8799999952316284, 0.8571428656578064, 0.8571428656578064, 0.7142857313156128, 0.800000011920929, 0.75, 1.0}, {0.7599999904632568, 0.7647058963775635, 0.9444444179534912, 0.6875, 0.699999988079071, 0.7857142686843872, 0.75, 0.0}, {0.5652173757553101, 0.6111111044883728, 0.800000011920929, 0.5714285969734192, 0.75, 0.3333333432674408, 1.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.19134078919887543, 0.14942528307437897, 0.1586901694536209, 0.16818182170391083, 0.16239316761493683, 0.1860465109348297, 0.3076923191547394, 0.3333333432674408}, {0.18145161867141724, 0.1624203771352768, 0.1690647453069687, 0.20000000298023224, 0.09459459781646729, 0.21875, 0.13333334028720856, 0.5}, {0.15079365670681, 0.13333334028720856, 0.11764705926179886, 0.13793103396892548, 0.095238097012043, 0.1428571492433548, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.022688599303364754, 0.009578543715178967, 0.006666666828095913, 0.011470281518995762, 0.006968641187995672, 0.018561484292149544, 0.011363636702299118, 0.0}, {0.02129097655415535, 0.01718440093100071, 0.007961783558130264, 0.010869565419852734, 0.012396694160997868, 0.025495750829577446, 0.04680851101875305, 0.07692307978868484}, {0.024403471499681473, 0.015991471707820892, 0.017735334113240242, 0.0091116176918149, 0.03956834599375725, 0.030456852167844772, 0.06611569970846176, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  
  //For the sample ttHToNonbb
  if(MCSample == 104){
    float BJetEff_temp[3][8] = {{0.7727272510528564, 0.8338983058929443, 0.8294797539710999, 0.8483245372772217, 0.8471502661705017, 0.8680555820465088, 0.78125, 0.0}, {0.773809552192688, 0.7799999713897705, 0.7579618096351624, 0.8249337077140808, 0.8519999980926514, 0.8090909123420715, 0.8695651888847351, 0.0}, {0.6763485670089722, 0.77173912525177, 0.678947389125824, 0.7552447319030762, 0.6987951993942261, 0.8333333134651184, 1.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.2133333384990692, 0.23333333432674408, 0.08490566164255142, 0.1428571492433548, 0.06451612710952759, 0.1111111119389534, 0.13333334028720856, 0.0}, {0.15454545617103577, 0.1599999964237213, 0.15789473056793213, 0.10204081982374191, 0.26923078298568726, 0.1875, 0.1666666716337204, 0.0}, {0.16923077404499054, 0.25806450843811035, 0.10526315867900848, 0.20000000298023224, 0.30000001192092896, 0.4000000059604645, 0.25, 0.0}};
    float LJetEff_temp[3][8] = {{0.0235294122248888, 0.013358778320252895, 0.018779342994093895, 0.020761245861649513, 0.0058139534667134285, 0.03846153989434242, 0.0, 0.0}, {0.03363518789410591, 0.009523809887468815, 0.02476780116558075, 0.022123893722891808, 0.016129031777381897, 0.0422535203397274, 0.11764705926179886, 0.0}, {0.024291498586535454, 0.024000000208616257, 0.005025125574320555, 0.008849557489156723, 0.02631578966975212, 0.0, 0.0, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  
  //For the sample VBF_HToZZTo4L
  if(MCSample == 105){
    float BJetEff_temp[3][8] = {{0.7916666865348816, 0.8275862336158752, 0.8333333134651184, 0.824999988079071, 0.739130437374115, 0.8999999761581421, 0.800000011920929, 0.0}, {0.6790123581886292, 0.8225806355476379, 0.7962962985038757, 0.7647058963775635, 0.7142857313156128, 0.8999999761581421, 1.0, 0.0}, {0.6515151262283325, 0.7777777910232544, 0.44897958636283875, 0.5, 0.692307710647583, 0.3333333432674408, 1.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.17584370076656342, 0.1666666716337204, 0.15315315127372742, 0.15436241030693054, 0.16326530277729034, 0.15238095819950104, 0.10000000149011612, 0.0}, {0.17620481550693512, 0.12814070284366608, 0.15420560538768768, 0.12195122241973877, 0.1256544440984726, 0.12987013161182404, 0.15789473056793213, 0.0}, {0.15198618173599243, 0.1425178200006485, 0.12709832191467285, 0.17226891219615936, 0.12751677632331848, 0.11320754885673523, 0.1428571492433548, 0.0}};
    float LJetEff_temp[3][8] = {{0.04055441543459892, 0.01322992704808712, 0.010536398738622665, 0.0070972321555018425, 0.007415254134684801, 0.009259259328246117, 0.0, 0.0}, {0.037649620324373245, 0.017463933676481247, 0.010550996288657188, 0.010917030274868011, 0.0173611119389534, 0.01886792480945587, 0.014563106931746006, 0.2222222238779068}, {0.03849390149116516, 0.018391521647572517, 0.013818671926856041, 0.017439192160964012, 0.023371104151010513, 0.01840490847826004, 0.07784431427717209, 0.0}};
    
    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  
  //For the sample VHToNonbb
  if(MCSample == 106){
    float BJetEff_temp[3][8] = {{1.0, 0.6666666865348816, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0}, {1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.06666667014360428, 0.20000000298023224, 0.20000000298023224, 0.0, 0.5, 0.0, 0.0, 0.0}, {0.1428571492433548, 0.3333333432674408, 0.4000000059604645, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.23076923191547394, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.019999999552965164, 0.01785714365541935, 0.02083333395421505, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.028037382289767265, 0.018518518656492233, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.021978022530674934, 0.05128205195069313, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};

    for(int i=0; i<3 ; i++){
      for(int j=0; j<8; j++){
        LJetEff[i][j] = LJetEff_temp[i][j];
        CJetEff[i][j] = CJetEff_temp[i][j];
        BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }

  //======================================================================//
  
  for (int i = 0; i < (int)Jet.size(); i++){
    float jet_prob_mc = 1.0;
    float jet_prob_data = 1.0;
    float jet_eff = 1.0;
    // choose pt bin
    int ptbin=-1;
    if     ( Jet.at(i).v.Pt() < 50  )  ptbin=0;
    else if( Jet.at(i).v.Pt() < 70  )  ptbin=1;
    else if( Jet.at(i).v.Pt() < 100 )  ptbin=2;
    else if( Jet.at(i).v.Pt() < 140 )  ptbin=3;
    else if( Jet.at(i).v.Pt() < 200 )  ptbin=4;
    else if( Jet.at(i).v.Pt() < 300 )  ptbin=5;
    else if( Jet.at(i).v.Pt() < 600 )  ptbin=6;
    else                               ptbin=7;
    // choose eta bin
    int etabin=-1;
    if      ( fabs(Jet.at(i).v.Eta()) < 0.8 ) etabin=0;
    else if ( fabs(Jet.at(i).v.Eta()) < 1.6 ) etabin=1;
    else if ( fabs(Jet.at(i).v.Eta()) < 2.4 ) etabin=2;
    else                                 continue;
    // choose flavor  
    if      ( Jet.at(i).hadronflavor == 5 ) jet_eff = BJetEff[etabin][ptbin];
    else if ( Jet.at(i).hadronflavor == 4 ) jet_eff = CJetEff[etabin][ptbin];
    else                                    jet_eff = LJetEff[etabin][ptbin];

    double SFfromPOG =  1.0;
    if( Jet.at(i).hadronflavor == 5 )
      SFfromPOG = getScaleFactors_bTagJets_MedWP_UL16postVFP(Jet.at(i).v.Eta(),Jet.at(i).v.Pt());
    else if(Jet.at(i).hadronflavor == 4 )
      SFfromPOG = getScaleFactors_cTagJets_Mis_UL16postVFP(Jet.at(i).v.Eta(),Jet.at(i).v.Pt());
    else
      SFfromPOG = getScaleFactors_LightTagJets_Mis_UL16postVFP(Jet.at(i).v.Eta(),Jet.at(i).v.Pt());
    
    // check if jet is tagged or not
    if (Jet_btagDeepFlavB[Jet.at(i).ind] > 0.2489){
      jet_prob_data = jet_eff*SFfromPOG;
      jet_prob_mc   = jet_eff;
    }
    else {    
      jet_prob_data = 1-(jet_eff*SFfromPOG);
      jet_prob_mc   = 1-jet_eff;
    }
    
    probability_data *= jet_prob_data;
    probability_mc   *= jet_prob_mc;
  }
  
  float scaleFactor = 1.0;
  if (probability_mc > 0.0) scaleFactor = probability_data/probability_mc;
  
  return scaleFactor;
}

